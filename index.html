<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Waterfall</title>
<style>
  body {
    background: black;
    margin: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    height: 100vh;
    color: white;
    font-family: monospace;
    white-space: pre;
  }
  #grid {
    line-height: 1;
    animation: shimmer 2s infinite ease-in-out;
  }
  @keyframes shimmer {
    0%, 100% { opacity: 0.9; }
    50% { opacity: 1; }
  }
  .word-glow {
    color: teal;
    text-shadow: 0 0 5px teal, 0 0 10px teal;
  }
  .sigil {
    color: #ff00ff;
    text-shadow: 0 0 5px #ff00ff;
  }
  .trail {
    color: #ff66ff;
  }
</style>
</head>
<body>
<pre id="grid"></pre>
<script>
  const rows = 45, cols = 80;
  const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
  const sigils = ["◉","∆","⟁","✶","☉"];
  const wordList = ["SUN", "SEA", "SKY", "GOD", "CAT", "DOG", "RUN", "KEY"];
  
  // Initialise grid
  let grid = Array.from({length: rows}, () =>
    Array.from({length: cols}, () => randLetter())
  );

  function randLetter() {
    return letters[Math.floor(Math.random() * letters.length)];
  }

  // Animation state
  let currentRow = 0;
  let sigilPos = 0;
  let trailLength = 2;
  let currentSigil = sigils[Math.floor(Math.random()*sigils.length)];

  function drawGrid() {
    let output = "";
    for (let r = 0; r < rows; r++) {
      for (let c = 0; c < cols; c++) {
        let ch = grid[r][c];
        let cls = "";

        // Sigil
        if (r === currentRow && c === sigilPos) {
          ch = currentSigil;
          cls = "sigil";
        }
        // Trail
        else if (r === currentRow && c < sigilPos && c >= sigilPos - trailLength) {
          cls = "trail";
        }
        // Glow words
        else {
          for (let w of wordList) {
            let segment = grid[r].slice(c, c + w.length).join("");
            if (segment === w) {
              cls = "word-glow";
              break;
            }
          }
        }

        if (cls) {
          output += `<span class="${cls}">${ch}</span>`;
        } else {
          output += ch;
        }
      }
      output += "\n";
    }
    document.getElementById("grid").innerHTML = output;
  }

  function update() {
    // Update current sigil position
    grid[currentRow][sigilPos] = randLetter();
    sigilPos++;

    // Wrap to next row
    if (sigilPos >= cols) {
      sigilPos = 0;
      currentRow = (currentRow + 1) % rows;
      currentSigil = sigils[Math.floor(Math.random()*sigils.length)];
    }

    drawGrid();
    requestAnimationFrame(update);
  }

  drawGrid();
  requestAnimationFrame(update);
</script>
</body>
</html>
