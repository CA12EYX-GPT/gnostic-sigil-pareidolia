<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gnostic Sigil Pareidolia</title>
  <style>
    body {
      margin: 0;
      background: #0b0b0f;
      overflow: hidden;
      font-family: 'Courier New', Courier, monospace;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(40, 1fr);
      grid-template-rows: repeat(30, 1fr);
      width: 100vw;
      height: 100vh;
      font-size: 0.85rem;
    }

    .cell {
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
      color: #eaeaea;
      transition: color 0.8s ease;
    }

    .glow {
      color: #00f0ff !important;
      text-shadow: 0 0 8px #00f0ff;
    }

    .trail {
      color: #888 !important;
    }

    .sigil {
      color: #e91e63 !important;
      text-shadow: 0 0 6px #e91e63;
    }
  </style>
</head>
<body>
  <div class="grid" id="grid"></div>
  <script>
    const gridEl = document.getElementById('grid');
    const cols = 40;
    const rows = 30;
    const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    const sigils = ['◉', '∆', '⟁', '✶', '⊙'];
    const grid = [];

    // Realistic, curated word list (acts like a dictionary)
    const wordList = new Set([
      // 3-letter
      "AND", "ART", "EYE", "SUN", "FUN", "RUN", "YES", "YOU", "SEE", "END",
      "NOW", "AIR", "KEY", "WAY", "OLD", "NEW", "GOD", "ONE", "TOP", "OWN",
      // 4-letter
      "TIME", "LOVE", "SOUL", "MIND", "SIGN", "CALL", "DARK", "FEEL", "HOPE",
      "FREE", "GLOW", "NAME", "TRUE", "OPEN", "STAR", "WISH", "RING", "LIFE",
      // 5-letter
      "LIGHT", "TRUTH", "HEART", "SIGIL", "ALIGN", "GRACE", "FORCE", "SIGHT",
      "INNER", "SPARK", "WORLD", "SENSE", "PEACE", "CYCLE", "SHIFT", "DREAM",
      "GATES", "VIBES", "UNITY", "SHELL", "ECHOE", "FLAME", "ALIVE", "BREAT",
      "VOICE", "NIGHT", "MORPH", "STILL", "CRYPT", "POWER", "DEPTH", "GIVEN"
    ]);

    function randomLetter() {
      return letters.charAt(Math.floor(Math.random() * letters.length));
    }

    function randomSigil() {
      return sigils[Math.floor(Math.random() * sigils.length)];
    }

    function buildGrid() {
      for (let col = 0; col < cols; col++) {
        grid[col] = [];
        for (let row = 0; row < rows; row++) {
          const cell = document.createElement('div');
          cell.className = 'cell';
          cell.innerText = randomLetter();
          grid[col][row] = cell;
          gridEl.appendChild(cell);
        }
      }

      // Optional stooge word: SUN
      grid[1][1].innerText = "S";
      grid[2][1].innerText = "U";
      grid[3][1].innerText = "N";

      grid[1][2].innerText = "U";
      grid[1][3].innerText = "N";
    }

    function glowCells(cells) {
      cells.forEach(c => c.classList.add('glow'));
      setTimeout(() => {
        cells.forEach(c => c.classList.remove('glow'));
      }, 1500);
    }

    function checkForWords(col, row) {
      for (let len = 3; len <= 5; len++) {
        // Vertical word detection
        if (row + len <= rows) {
          const vCells = [];
          let vWord = '';
          for (let i = 0; i < len; i++) {
            const cell = grid[col][row + i];
            vCells.push(cell);
            vWord += cell.innerText;
          }
          if (wordList.has(vWord)) glowCells(vCells);
        }

        // Horizontal word detection
        if (col + len <= cols) {
          const hCells = [];
          let hWord = '';
          for (let i = 0; i < len; i++) {
            const cell = grid[col + i][row];
            hCells.push(cell);
            hWord += cell.innerText;
          }
          if (wordList.has(hWord)) glowCells(hCells);
        }
      }
    }

    function dropTrail(col) {
      const dropLength = Math.floor(Math.random() * 5) + 5;
      let position = 0;

      const interval = setInterval(() => {
        if (position < rows + dropLength) {
          for (let i = 0; i < dropLength; i++) {
            const row = position - i;
            if (row >= 0 && row < rows) {
              const cell = grid[col][row];
              const isLead = i === 0;
              const showSigil = Math.random() < 0.02;

              if (isLead && showSigil) {
                cell.innerText = randomSigil();
                cell.classList.add('sigil');
              } else if (isLead) {
                cell.innerText = randomLetter();
              }

              cell.classList.add('trail');
              setTimeout(() => {
                if (isLead && showSigil) {
                  cell.innerText = randomLetter();
                  cell.classList.remove('sigil');
                }
                cell.classList.remove('trail');
              }, 800);
            }
          }
          position++;
        } else {
          clearInterval(interval);
        }
      }, 90);
    }

    function triggerDrops() {
      const activeCols = [...Array(cols).keys()];
      const numDrops = Math.floor(Math.random() * 4) + 2;
      for (let i = 0; i < numDrops; i++) {
        const col = activeCols.splice(Math.floor(Math.random() * activeCols.length), 1)[0];
        dropTrail(col);
      }
    }

    window.addEventListener("load", () => {
      buildGrid();

      setInterval(() => {
        triggerDrops();
        // Scan after slight delay to let cells update
        setTimeout(() => {
          for (let col = 0; col < cols; col++) {
            for (let row = 0; row < rows; row++) {
              checkForWords(col, row);
            }
          }
        }, 300);
      }, 1000);
    });
  </script>
</body>
</html>
